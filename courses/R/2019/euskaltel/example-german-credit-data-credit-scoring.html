<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> 8 Example: German credit data (Credit scoring) | Introducción al software estadístico R</title>
  <meta name="description" content="Material del curso de Formación en R Euskaltel">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content=" 8 Example: German credit data (Credit scoring) | Introducción al software estadístico R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Material del curso de Formación en R Euskaltel" />
  <meta name="github-repo" content="idaejin/xxx" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 8 Example: German credit data (Credit scoring) | Introducción al software estadístico R" />
  
  <meta name="twitter:description" content="Material del curso de Formación en R Euskaltel" />
  

<meta name="author" content="Dae-Jin Lee &lt; dlee@bcamath.org &gt;">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="regresion-logistica.html">
<link rel="next" href="example-predict-adults-salary.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Curso de formación en R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Información y pre-requisitos</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introducción al software estadístico <code>R</code></a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#algunas-cuestiones-a-tener-en-cuenta-sobre-r"><i class="fa fa-check"></i><b>2.1</b> Algunas cuestiones a tener en cuenta sobre <code>R</code></a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#guardar-los-resultados-y-el-codigo"><i class="fa fa-check"></i><b>2.2</b> Guardar los resultados y el código</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#rstudio"><i class="fa fa-check"></i><b>2.3</b> Rstudio</a></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#instalar-un-paquete-de-r"><i class="fa fa-check"></i><b>2.4</b> Instalar un paquete de <code>R</code></a></li>
<li class="chapter" data-level="2.5" data-path="intro.html"><a href="intro.html#empezando-con-r"><i class="fa fa-check"></i><b>2.5</b> Empezando con <code>R</code></a></li>
<li class="chapter" data-level="2.6" data-path="intro.html"><a href="intro.html#instalar-y-cargar-librerias-en-r"><i class="fa fa-check"></i><b>2.6</b> Instalar y cargar librerías en <code>R</code></a></li>
<li class="chapter" data-level="2.7" data-path="intro.html"><a href="intro.html#lectura-de-datos"><i class="fa fa-check"></i><b>2.7</b> Lectura de datos</a></li>
<li class="chapter" data-level="2.8" data-path="intro.html"><a href="intro.html#importar-datos"><i class="fa fa-check"></i><b>2.8</b> Importar datos</a></li>
<li class="chapter" data-level="2.9" data-path="intro.html"><a href="intro.html#exportar-datos"><i class="fa fa-check"></i><b>2.9</b> Exportar datos</a></li>
<li class="chapter" data-level="2.10" data-path="intro.html"><a href="intro.html#vectores"><i class="fa fa-check"></i><b>2.10</b> Vectores</a></li>
<li class="chapter" data-level="2.11" data-path="intro.html"><a href="intro.html#estadistica-basica"><i class="fa fa-check"></i><b>2.11</b> Estadística básica</a></li>
<li class="chapter" data-level="2.12" data-path="intro.html"><a href="intro.html#vectores-caracteres-y-variables-factor"><i class="fa fa-check"></i><b>2.12</b> Vectores caracteres y variables factor</a></li>
<li class="chapter" data-level="2.13" data-path="intro.html"><a href="intro.html#data-frames"><i class="fa fa-check"></i><b>2.13</b> Data frames</a></li>
<li class="chapter" data-level="2.14" data-path="intro.html"><a href="intro.html#trabajando-con-data-frames"><i class="fa fa-check"></i><b>2.14</b> Trabajando con data frames</a></li>
<li class="chapter" data-level="2.15" data-path="intro.html"><a href="intro.html#vectores-logicos"><i class="fa fa-check"></i><b>2.15</b> Vectores lógicos</a></li>
<li class="chapter" data-level="2.16" data-path="intro.html"><a href="intro.html#trabajando-con-vectores"><i class="fa fa-check"></i><b>2.16</b> Trabajando con vectores</a></li>
<li class="chapter" data-level="2.17" data-path="intro.html"><a href="intro.html#matrices-y-arrays"><i class="fa fa-check"></i><b>2.17</b> Matrices y arrays</a></li>
<li class="chapter" data-level="2.18" data-path="intro.html"><a href="intro.html#factores"><i class="fa fa-check"></i><b>2.18</b> Factores</a></li>
<li class="chapter" data-level="2.19" data-path="intro.html"><a href="intro.html#indexando-vectores-con-condiciones-logicas"><i class="fa fa-check"></i><b>2.19</b> Indexando vectores con condiciones lógicas</a></li>
<li class="chapter" data-level="2.20" data-path="intro.html"><a href="intro.html#valores-faltantes"><i class="fa fa-check"></i><b>2.20</b> Valores faltantes</a></li>
<li class="chapter" data-level="2.21" data-path="intro.html"><a href="intro.html#trabajando-con-data-frames-1"><i class="fa fa-check"></i><b>2.21</b> Trabajando con data frames</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="basic.html"><a href="basic.html"><i class="fa fa-check"></i><b>3</b> Análisis de datos básico en <code>R</code></a><ul>
<li class="chapter" data-level="3.1" data-path="basic.html"><a href="basic.html#graficos-sencillos"><i class="fa fa-check"></i><b>3.1</b> Gráficos sencillos</a></li>
<li class="chapter" data-level="3.2" data-path="basic.html"><a href="basic.html#scatterplots"><i class="fa fa-check"></i><b>3.2</b> Scatterplots</a></li>
<li class="chapter" data-level="3.3" data-path="basic.html"><a href="basic.html#mas-opciones-graficas"><i class="fa fa-check"></i><b>3.3</b> más opciones gráficas</a></li>
<li class="chapter" data-level="3.4" data-path="basic.html"><a href="basic.html#tablas-de-clasificacion-cruzada-o-de-contigencia"><i class="fa fa-check"></i><b>3.4</b> Tablas de clasificación cruzada o de contigencia</a></li>
<li class="chapter" data-level="3.5" data-path="basic.html"><a href="basic.html#calculos-sobre-tablas-de-contigencia"><i class="fa fa-check"></i><b>3.5</b> cálculos sobre tablas de contigencia</a></li>
<li class="chapter" data-level="3.6" data-path="basic.html"><a href="basic.html#datos-cualitativos"><i class="fa fa-check"></i><b>3.6</b> Datos cualitativos</a></li>
<li class="chapter" data-level="3.7" data-path="basic.html"><a href="basic.html#datos-cuantitativos"><i class="fa fa-check"></i><b>3.7</b> Datos cuantitativos</a><ul>
<li class="chapter" data-level="3.7.1" data-path="basic.html"><a href="basic.html#distribuciones-de-frecuencias"><i class="fa fa-check"></i><b>3.7.1</b> Distribuciones de frecuencias</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="introduccion-a-la-programacion-basica-con-r.html"><a href="introduccion-a-la-programacion-basica-con-r.html"><i class="fa fa-check"></i><b>4</b> Introducción a la programación básica con <code>R</code></a><ul>
<li class="chapter" data-level="4.1" data-path="introduccion-a-la-programacion-basica-con-r.html"><a href="introduccion-a-la-programacion-basica-con-r.html#condicionales"><i class="fa fa-check"></i><b>4.1</b> Condicionales</a></li>
<li class="chapter" data-level="4.2" data-path="introduccion-a-la-programacion-basica-con-r.html"><a href="introduccion-a-la-programacion-basica-con-r.html#operadores-logicos"><i class="fa fa-check"></i><b>4.2</b> Operadores Lógicos</a></li>
<li class="chapter" data-level="4.3" data-path="introduccion-a-la-programacion-basica-con-r.html"><a href="introduccion-a-la-programacion-basica-con-r.html#if"><i class="fa fa-check"></i><b>4.3</b> <code>if</code></a></li>
<li class="chapter" data-level="4.4" data-path="introduccion-a-la-programacion-basica-con-r.html"><a href="introduccion-a-la-programacion-basica-con-r.html#ifelse"><i class="fa fa-check"></i><b>4.4</b> <code>ifelse</code></a></li>
<li class="chapter" data-level="4.5" data-path="introduccion-a-la-programacion-basica-con-r.html"><a href="introduccion-a-la-programacion-basica-con-r.html#loops-o-bucles"><i class="fa fa-check"></i><b>4.5</b> Loops o Bucles</a><ul>
<li class="chapter" data-level="4.5.1" data-path="introduccion-a-la-programacion-basica-con-r.html"><a href="introduccion-a-la-programacion-basica-con-r.html#for"><i class="fa fa-check"></i><b>4.5.1</b> <code>for</code></a></li>
<li class="chapter" data-level="4.5.2" data-path="introduccion-a-la-programacion-basica-con-r.html"><a href="introduccion-a-la-programacion-basica-con-r.html#while"><i class="fa fa-check"></i><b>4.5.2</b> <code>while</code></a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="introduccion-a-la-programacion-basica-con-r.html"><a href="introduccion-a-la-programacion-basica-con-r.html#famila-de-funciones-apply"><i class="fa fa-check"></i><b>4.6</b> Famila de funciones <code>apply</code></a></li>
<li class="chapter" data-level="4.7" data-path="introduccion-a-la-programacion-basica-con-r.html"><a href="introduccion-a-la-programacion-basica-con-r.html#other-loops"><i class="fa fa-check"></i><b>4.7</b> Other Loops</a></li>
<li class="chapter" data-level="4.8" data-path="introduccion-a-la-programacion-basica-con-r.html"><a href="introduccion-a-la-programacion-basica-con-r.html#improving-speed-performance-of-loops"><i class="fa fa-check"></i><b>4.8</b> Improving Speed Performance of Loops</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="distribuciones-de-probabilidad-en-r.html"><a href="distribuciones-de-probabilidad-en-r.html"><i class="fa fa-check"></i><b>5</b> Distribuciones de probabilidad en R</a><ul>
<li class="chapter" data-level="5.1" data-path="distribuciones-de-probabilidad-en-r.html"><a href="distribuciones-de-probabilidad-en-r.html#distribucion-binomial-binnp"><i class="fa fa-check"></i><b>5.1</b> Distribución binomial <span class="math inline">\(Bin(n,p)\)</span></a></li>
<li class="chapter" data-level="5.2" data-path="distribuciones-de-probabilidad-en-r.html"><a href="distribuciones-de-probabilidad-en-r.html#distribucion-de-poisson-poislambda"><i class="fa fa-check"></i><b>5.2</b> Distribución de Poisson <span class="math inline">\(Pois(\lambda)\)</span></a><ul>
<li class="chapter" data-level="5.2.1" data-path="distribuciones-de-probabilidad-en-r.html"><a href="distribuciones-de-probabilidad-en-r.html#aproximacion-de-binomial-como-poisson"><i class="fa fa-check"></i><b>5.2.1</b> Aproximación de Binomial como Poisson</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="distribuciones-de-probabilidad-en-r.html"><a href="distribuciones-de-probabilidad-en-r.html#distribution-exponencial-explambda"><i class="fa fa-check"></i><b>5.3</b> Distribution Exponencial <span class="math inline">\(Exp(\lambda)\)</span></a></li>
<li class="chapter" data-level="5.4" data-path="distribuciones-de-probabilidad-en-r.html"><a href="distribuciones-de-probabilidad-en-r.html#distribution-normal-mathcalnmusigma2"><i class="fa fa-check"></i><b>5.4</b> Distribution Normal <span class="math inline">\(\mathcal{N}(\mu,\sigma^2)\)</span></a></li>
<li class="chapter" data-level="5.5" data-path="distribuciones-de-probabilidad-en-r.html"><a href="distribuciones-de-probabilidad-en-r.html#distribucion-uniforme-uab"><i class="fa fa-check"></i><b>5.5</b> Distribución Uniforme <span class="math inline">\(U(a,b)\)</span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="modelos-lineales-y-analisis-de-la-varianza.html"><a href="modelos-lineales-y-analisis-de-la-varianza.html"><i class="fa fa-check"></i><b>6</b> Modelos lineales y análisis de la varianza</a><ul>
<li class="chapter" data-level="6.1" data-path="modelos-lineales-y-analisis-de-la-varianza.html"><a href="modelos-lineales-y-analisis-de-la-varianza.html#principios-de-la-modelizacion-estadistica"><i class="fa fa-check"></i><b>6.1</b> Principios de la modelización estadística</a><ul>
<li class="chapter" data-level="6.1.1" data-path="modelos-lineales-y-analisis-de-la-varianza.html"><a href="modelos-lineales-y-analisis-de-la-varianza.html#identificar-y-caracterizar-variables"><i class="fa fa-check"></i><b>6.1.1</b> Identificar y Caracterizar Variables</a></li>
<li class="chapter" data-level="6.1.2" data-path="modelos-lineales-y-analisis-de-la-varianza.html"><a href="modelos-lineales-y-analisis-de-la-varianza.html#tipos-de-variables-y-tipo-de-modelo"><i class="fa fa-check"></i><b>6.1.2</b> Tipos de variables y tipo de modelo</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="modelos-lineales-y-analisis-de-la-varianza.html"><a href="modelos-lineales-y-analisis-de-la-varianza.html#el-modelo-lineal-general"><i class="fa fa-check"></i><b>6.2</b> El modelo lineal general</a></li>
<li class="chapter" data-level="6.3" data-path="modelos-lineales-y-analisis-de-la-varianza.html"><a href="modelos-lineales-y-analisis-de-la-varianza.html#definicion-de-modelos-en-r"><i class="fa fa-check"></i><b>6.3</b> Definición de modelos en <code>R</code></a><ul>
<li class="chapter" data-level="6.3.1" data-path="modelos-lineales-y-analisis-de-la-varianza.html"><a href="modelos-lineales-y-analisis-de-la-varianza.html#ejemplo-datos-de-precios-de-viviendas-en-boston"><i class="fa fa-check"></i><b>6.3.1</b> Ejemplo: Datos de precios de viviendas en Boston</a></li>
<li class="chapter" data-level="6.3.2" data-path="modelos-lineales-y-analisis-de-la-varianza.html"><a href="modelos-lineales-y-analisis-de-la-varianza.html#regresion-lineal-multiple"><i class="fa fa-check"></i><b>6.3.2</b> Regresión lineal múltiple</a></li>
<li class="chapter" data-level="6.3.3" data-path="modelos-lineales-y-analisis-de-la-varianza.html"><a href="modelos-lineales-y-analisis-de-la-varianza.html#ejemplo"><i class="fa fa-check"></i><b>6.3.3</b> Ejemplo:</a></li>
<li class="chapter" data-level="6.3.4" data-path="modelos-lineales-y-analisis-de-la-varianza.html"><a href="modelos-lineales-y-analisis-de-la-varianza.html#modelos-con-interacciones"><i class="fa fa-check"></i><b>6.3.4</b> Modelos con interacciones</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="regresion-logistica.html"><a href="regresion-logistica.html"><i class="fa fa-check"></i><b>7</b> Regresión logística</a></li>
<li class="chapter" data-level="8" data-path="example-german-credit-data-credit-scoring.html"><a href="example-german-credit-data-credit-scoring.html"><i class="fa fa-check"></i><b>8</b> Example: German credit data (Credit scoring)</a></li>
<li class="chapter" data-level="9" data-path="example-predict-adults-salary.html"><a href="example-predict-adults-salary.html"><i class="fa fa-check"></i><b>9</b> Example: Predict adults salary</a></li>
<li class="chapter" data-level="10" data-path="example-titanic-survivors-data.html"><a href="example-titanic-survivors-data.html"><i class="fa fa-check"></i><b>10</b> Example: Titanic survivors data</a></li>
<li class="divider"></li>
<li><a href="http://idaejin.github.io/" target="blank">Mi página personal</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introducción al software estadístico <code>R</code></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="example-german-credit-data-credit-scoring" class="section level1">
<h1><span class="header-section-number"> 8</span> Example: German credit data (Credit scoring)</h1>
<p>When a bank receives a loan application, based on the applicant’s profile, the bank has to make a decision on whether to proceed with the loan approval or not. Two types of risks are associated with the bank’s decision:</p>
<ul>
<li><p>If the applicant has a good credit risk, i.e. is likely to repay the loan, then not approving the loan to the person results in a loss of business for the bank.</p></li>
<li><p>If the applicant has a bad credit risk, i.e., is not likely to repay the loan, then approving the loan to the person results in a financial loss to the bank.</p></li>
</ul>
<p> </p>
<p>The aim of this type of analysis is to <strong>minimized the risk and maximize the profit of the bank</strong></p>
<p>To minimize loss from the bank’s perspective, the bank needs a decision rule regarding who to give approval of the loan and who not to. An applicant’s demographic and socio-economic profiles are considered by loan managers before a decision is taken regarding his/her loan application.</p>
<p> </p>
<p>The <a href="https://archive.ics.uci.edu/ml/datasets/statlog+(german+credit+data)">German Credit Data</a> contains data on 20 variables and the classification whether an applicant is considered a <em>Good</em> or a <em>Bad</em> credit risk for 1000 loan applicants.</p>
<p> </p>
<p>A <strong>predictive model</strong> developed on this data is expected to provide a bank manager guidance for making a decision whether to approve a loan to a prospective applicant based on his/her profiles.</p>
<p><a href="ftp.ics.uci.edu/pub/machine-learning-databases/statlog/german/german.doc">See description</a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># German Credit Data</span>
gcreditdata &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;https://archive.ics.uci.edu/ml/machine-learning-databases/statlog/german/german.data&quot;</span>, <span class="dt">header =</span> <span class="ot">FALSE</span>)

<span class="kw">colnames</span>(gcreditdata)&lt;-<span class="kw">c</span>(<span class="st">&quot;account.status&quot;</span>,<span class="st">&quot;months&quot;</span>,
                <span class="st">&quot;credit.history&quot;</span>,<span class="st">&quot;purpose&quot;</span>,<span class="st">&quot;credit.amount&quot;</span>,
                <span class="st">&quot;savings&quot;</span>,<span class="st">&quot;employment&quot;</span>,<span class="st">&quot;installment.rate&quot;</span>,<span class="st">&quot;personal.status&quot;</span>,
                <span class="st">&quot;guarantors&quot;</span>,<span class="st">&quot;residence&quot;</span>,<span class="st">&quot;property&quot;</span>,<span class="st">&quot;age&quot;</span>,<span class="st">&quot;other.installments&quot;</span>,
                <span class="st">&quot;housing&quot;</span>,<span class="st">&quot;credit.cards&quot;</span>,<span class="st">&quot;job&quot;</span>,<span class="st">&quot;dependents&quot;</span>,<span class="st">&quot;phone&quot;</span>,<span class="st">&quot;foreign.worker&quot;</span>,<span class="st">&quot;credit.rating&quot;</span>)

<span class="kw">head</span>(gcreditdata)</code></pre></div>
<pre><code>##   account.status months credit.history purpose credit.amount savings
## 1            A11      6            A34     A43          1169     A65
## 2            A12     48            A32     A43          5951     A61
## 3            A14     12            A34     A46          2096     A61
## 4            A11     42            A32     A42          7882     A61
## 5            A11     24            A33     A40          4870     A61
## 6            A14     36            A32     A46          9055     A65
##   employment installment.rate personal.status guarantors residence
## 1        A75                4             A93       A101         4
## 2        A73                2             A92       A101         2
## 3        A74                2             A93       A101         3
## 4        A74                2             A93       A103         4
## 5        A73                3             A93       A101         4
## 6        A73                2             A93       A101         4
##   property age other.installments housing credit.cards  job dependents
## 1     A121  67               A143    A152            2 A173          1
## 2     A121  22               A143    A152            1 A173          1
## 3     A121  49               A143    A152            1 A172          2
## 4     A122  45               A143    A153            1 A173          2
## 5     A124  53               A143    A153            2 A173          2
## 6     A124  35               A143    A153            1 A172          2
##   phone foreign.worker credit.rating
## 1  A192           A201             1
## 2  A191           A201             2
## 3  A191           A201             1
## 4  A191           A201             1
## 5  A191           A201             2
## 6  A192           A201             1</code></pre>
<p> </p>
<p>Rename some factor levels:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(gcreditdata<span class="op">$</span>credit.rating) <span class="co"># Good = 1 / Bad = 2</span></code></pre></div>
<pre><code>## 
##   1   2 
## 700 300</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gcreditdata<span class="op">$</span>credit.rating &lt;-<span class="st"> </span><span class="kw">ifelse</span>(gcreditdata<span class="op">$</span>credit.rating<span class="op">==</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>)
<span class="kw">table</span>(gcreditdata<span class="op">$</span>credit.rating) <span class="co"># Good = 1 / Bad = 0</span></code></pre></div>
<pre><code>## 
##   0   1 
## 300 700</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">levels</span>(gcreditdata<span class="op">$</span>account.status) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;&lt;0DM&quot;</span>,<span class="st">&quot;&lt;200DM&quot;</span>,<span class="st">&quot;&gt;200DM&quot;</span>,<span class="st">&quot;NoStatus&quot;</span>)
<span class="kw">levels</span>(gcreditdata<span class="op">$</span>credit.history) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;No&quot;</span>,<span class="st">&quot;Allpaid&quot;</span>,<span class="st">&quot;Allpaidtillnow&quot;</span>,<span class="st">&quot;Delayinpaying&quot;</span>,<span class="st">&quot;Critical&quot;</span>)
<span class="kw">levels</span>(gcreditdata<span class="op">$</span>purpose) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;car(new)&quot;</span>,<span class="st">&quot;car(used)&quot;</span>,<span class="st">&quot;furniture/equipment&quot;</span>,<span class="st">&quot;radio/television&quot;</span>,<span class="st">&quot;domesticappliances&quot;</span>,
<span class="st">&quot;repairs&quot;</span>,<span class="st">&quot;education&quot;</span>,<span class="st">&quot;vacation-doesnotexist?&quot;</span>,<span class="st">&quot;retraining&quot;</span>,<span class="st">&quot;business&quot;</span>,<span class="st">&quot;others&quot;</span>)</code></pre></div>
<p> </p>
<p>Let us divide the data into two sets (training and test), 70%/30%.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gcredit.matrix &lt;-<span class="st"> </span><span class="kw">model.matrix</span>(credit.rating <span class="op">~</span><span class="st"> </span>. , <span class="dt">data =</span> gcreditdata)

n&lt;-<span class="st"> </span><span class="kw">dim</span>(gcreditdata)[<span class="dv">1</span>]

<span class="kw">set.seed</span>(<span class="dv">1234</span>) <span class="co"># select a random sample with</span>
 train &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n , <span class="fl">0.7</span><span class="op">*</span>n)
xtrain &lt;-<span class="st"> </span>gcredit.matrix[train,]
xtest  &lt;-<span class="st"> </span>gcredit.matrix[<span class="op">-</span>train,]

ytrain &lt;-<span class="st"> </span>gcreditdata<span class="op">$</span>credit.rating[train]
ytrain &lt;-<span class="st"> </span><span class="kw">as.factor</span>(ytrain<span class="op">-</span><span class="dv">1</span>) <span class="co"># convert to 0/1 factor</span>
 ytest &lt;-<span class="st"> </span>gcreditdata<span class="op">$</span>credit.rating[<span class="op">-</span>train]
ytest  &lt;-<span class="st"> </span><span class="kw">as.factor</span>(ytest<span class="op">-</span><span class="dv">1</span>) <span class="co">#  convert to 0/1 factor</span></code></pre></div>
<p> </p>
<p>A logistic model can be fitted with <code>glm</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m1 &lt;-<span class="st"> </span><span class="kw">glm</span>(credit.rating <span class="op">~</span><span class="st"> </span>. , <span class="dt">family =</span> binomial, <span class="dt">data=</span> <span class="kw">data.frame</span>(<span class="dt">credit.rating=</span> ytrain, xtrain))
<span class="kw">summary</span>(m1)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = credit.rating ~ ., family = binomial, data = data.frame(credit.rating = ytrain, 
##     xtrain))
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.8353  -0.6178   0.3415   0.6729   2.0514  
## 
## Coefficients: (2 not defined because of singularities)
##                                 Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                    5.259e-01  1.371e+00   0.384 0.701257    
## X.Intercept.                          NA         NA      NA       NA    
## account.status.200DM           3.532e-01  2.719e-01   1.299 0.193876    
## account.status.200DM.1         8.198e-01  4.626e-01   1.772 0.076353 .  
## account.statusNoStatus         1.487e+00  2.782e-01   5.344 9.08e-08 ***
## months                        -3.687e-02  1.156e-02  -3.189 0.001428 ** 
## credit.historyAllpaid         -1.347e-01  6.539e-01  -0.206 0.836779    
## credit.historyAllpaidtillnow   5.296e-01  4.975e-01   1.065 0.287038    
## credit.historyDelayinpaying    7.156e-01  5.575e-01   1.284 0.199266    
## credit.historyCritical         1.439e+00  5.073e-01   2.837 0.004559 ** 
## purposecar.used.               1.838e+00  4.856e-01   3.786 0.000153 ***
## purposefurniture.equipment     1.095e+00  9.231e-01   1.186 0.235728    
## purposeradio.television        8.879e-01  3.289e-01   2.700 0.006944 ** 
## purposedomesticappliances      9.928e-01  3.107e-01   3.196 0.001395 ** 
## purposerepairs                 5.399e-01  9.006e-01   0.599 0.548881    
## purposeeducation              -4.889e-01  6.587e-01  -0.742 0.457933    
## purposevacation.doesnotexist. -1.800e-01  4.648e-01  -0.387 0.698616    
## purposeretraining              2.093e+00  1.266e+00   1.653 0.098417 .  
## purposebusiness                5.772e-01  3.985e-01   1.448 0.147489    
## purposeothers                         NA         NA      NA       NA    
## credit.amount                 -1.107e-04  5.456e-05  -2.028 0.042526 *  
## savingsA62                     5.219e-01  3.548e-01   1.471 0.141326    
## savingsA63                     8.722e-01  5.710e-01   1.528 0.126623    
## savingsA64                     1.746e+00  6.533e-01   2.673 0.007514 ** 
## savingsA65                     1.354e+00  3.350e-01   4.042 5.30e-05 ***
## employmentA72                  1.729e-01  5.327e-01   0.324 0.745566    
## employmentA73                  2.462e-01  5.116e-01   0.481 0.630356    
## employmentA74                  1.182e+00  5.660e-01   2.089 0.036736 *  
## employmentA75                  4.924e-02  5.076e-01   0.097 0.922712    
## installment.rate              -4.157e-01  1.098e-01  -3.787 0.000152 ***
## personal.statusA92             5.279e-02  4.718e-01   0.112 0.910902    
## personal.statusA93             6.791e-01  4.577e-01   1.484 0.137906    
## personal.statusA94             2.017e-01  5.550e-01   0.363 0.716253    
## guarantorsA102                 1.880e-01  5.068e-01   0.371 0.710613    
## guarantorsA103                 1.024e+00  5.814e-01   1.761 0.078259 .  
## residence                      5.357e-02  1.047e-01   0.512 0.608926    
## propertyA122                  -4.618e-01  3.142e-01  -1.470 0.141584    
## propertyA123                  -4.679e-01  2.906e-01  -1.610 0.107366    
## propertyA124                  -7.642e-01  5.658e-01  -1.351 0.176834    
## age                            1.872e-02  1.172e-02   1.598 0.110121    
## other.installmentsA142        -1.259e-01  5.197e-01  -0.242 0.808648    
## other.installmentsA143         3.400e-01  2.892e-01   1.176 0.239669    
## housingA152                    5.768e-01  2.935e-01   1.965 0.049384 *  
## housingA153                    7.825e-01  6.261e-01   1.250 0.211387    
## credit.cards                  -3.720e-01  2.456e-01  -1.515 0.129882    
## jobA172                       -8.402e-01  8.307e-01  -1.011 0.311822    
## jobA173                       -9.497e-01  7.970e-01  -1.192 0.233388    
## jobA174                       -9.513e-01  8.262e-01  -1.152 0.249525    
## dependents                    -2.108e-01  3.080e-01  -0.685 0.493620    
## phoneA192                      4.876e-01  2.556e-01   1.908 0.056400 .  
## foreign.workerA202             9.540e-01  7.550e-01   1.264 0.206386    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 839.40  on 699  degrees of freedom
## Residual deviance: 596.11  on 651  degrees of freedom
## AIC: 694.11
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p> </p>
<p>Significant variables</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sig.var&lt;-<span class="st"> </span><span class="kw">summary</span>(m1)<span class="op">$</span>coeff[<span class="op">-</span><span class="dv">1</span>,<span class="dv">4</span>] <span class="op">&lt;</span><span class="fl">0.01</span>
<span class="kw">names</span>(sig.var)[sig.var <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>]</code></pre></div>
<pre><code>## [1] &quot;account.statusNoStatus&quot;    &quot;months&quot;                   
## [3] &quot;credit.historyCritical&quot;    &quot;purposecar.used.&quot;         
## [5] &quot;purposeradio.television&quot;   &quot;purposedomesticappliances&quot;
## [7] &quot;savingsA64&quot;                &quot;savingsA65&quot;               
## [9] &quot;installment.rate&quot;</code></pre>
<p> </p>
<p>With <code>predict</code> we can predict with the logistic model the test set.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pred1&lt;-<span class="st"> </span><span class="kw">predict.glm</span>(m1,<span class="dt">newdata =</span> <span class="kw">data.frame</span>(ytest,xtest), <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)
result1&lt;-<span class="st"> </span><span class="kw">table</span>(ytest, <span class="kw">floor</span>(pred1<span class="op">+</span><span class="fl">1.5</span>))
result1</code></pre></div>
<pre><code>##      
## ytest   1   2
##    -1  48  51
##    0   25 176</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">error1&lt;-<span class="st"> </span><span class="kw">sum</span>(result1[<span class="dv">1</span>,<span class="dv">2</span>], result1[<span class="dv">2</span>,<span class="dv">1</span>])<span class="op">/</span><span class="kw">sum</span>(result1)
error1</code></pre></div>
<pre><code>## [1] 0.2533333</code></pre>
<p> </p>
<p>ROC curve with <code>ROCR</code> library</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ROCR)</code></pre></div>
<pre><code>## Loading required package: gplots</code></pre>
<pre><code>## 
## Attaching package: &#39;gplots&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     lowess</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pred =<span class="st"> </span><span class="kw">prediction</span>(pred1,ytest)
perf &lt;-<span class="st"> </span><span class="kw">performance</span>(pred, <span class="st">&quot;tpr&quot;</span>, <span class="st">&quot;fpr&quot;</span>)
<span class="kw">plot</span>(perf)</code></pre></div>
<p><img src="curso_Euskaltel_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">AUCLog1=<span class="kw">performance</span>(pred, <span class="dt">measure =</span> <span class="st">&quot;auc&quot;</span>)<span class="op">@</span>y.values[[<span class="dv">1</span>]]
<span class="kw">cat</span>(<span class="st">&quot;AUC: &quot;</span>,AUCLog1,<span class="st">&quot;n&quot;</span>)</code></pre></div>
<pre><code>## AUC:  0.7699382 n</code></pre>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="regresion-logistica.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="example-predict-adults-salary.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/idaejin/master/06-logistic-reg.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["curso_Euskaltel.pdf", "curso_Euskaltel.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
